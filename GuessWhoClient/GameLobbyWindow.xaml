<Window x:Class="GuessWhoClient.GameLobbyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:conv="clr-namespace:GuessWhoClient.Converters"
        mc:Ignorable="d"
        Title="GameLobbyWindow"
        Height="720" Width="1120"
        Background="{StaticResource Brush.Bg}"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/PixelTheme.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <BooleanToVisibilityConverter x:Key="BoolToVis" />

            <Style x:Key="Card" TargetType="Border">
                <Setter Property="Background" Value="{StaticResource Brush.Card}" />
                <Setter Property="BorderBrush" Value="{StaticResource Brush.AccentDark}" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="CornerRadius" Value="12" />
                <Setter Property="Padding" Value="10" />
                <Setter Property="SnapsToDevicePixels" Value="True" />
            </Style>

            <Style x:Key="Txt.Title"
                   TargetType="TextBlock"
                   BasedOn="{StaticResource Txt.Pixel}">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="Margin" Value="0,0,0,8" />
            </Style>

            <Style x:Key="Btn.Icon" TargetType="Button">
                <Setter Property="Foreground" Value="{StaticResource Brush.TextLight}" />
                <Setter Property="Background" Value="{StaticResource Brush.Panel}" />
                <Setter Property="BorderBrush" Value="{StaticResource Brush.AccentDark}" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="FontFamily" Value="{StaticResource Font.Pixel}" />
                <Setter Property="Padding" Value="8,6" />
                <Setter Property="Cursor" Value="Hand" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="10">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource Brush.Card}" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Opacity" Value="0.9" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="ChipToggle" TargetType="ToggleButton">
                <Setter Property="MinWidth" Value="86" />
                <Setter Property="MinHeight" Value="32" />
                <Setter Property="Margin" Value="4" />
                <Setter Property="Padding" Value="10,4" />
                <Setter Property="FontFamily" Value="{StaticResource Font.Pixel}" />
                <Setter Property="Foreground" Value="{StaticResource Brush.TextLight}" />
                <Setter Property="Background" Value="{StaticResource Brush.Panel}" />
                <Setter Property="BorderBrush" Value="{StaticResource Brush.AccentDark}" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border CornerRadius="10"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" Value="{StaticResource Brush.Accent}" />
                                    <Setter Property="Foreground" Value="{StaticResource Brush.Bg}" />
                                    <Setter Property="BorderBrush" Value="{StaticResource Brush.AccentDark}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" Value="0.6" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="ReadyToggle" TargetType="ToggleButton">
                <Setter Property="MinWidth" Value="120" />
                <Setter Property="MinHeight" Value="40" />
                <Setter Property="Padding" Value="12,6" />
                <Setter Property="FontSize" Value="18" />
                <Setter Property="FontFamily" Value="{StaticResource Font.Pixel}" />
                <Setter Property="Foreground" Value="{StaticResource Brush.TextLight}" />
                <Setter Property="Background" Value="{StaticResource Brush.Panel}" />
                <Setter Property="BorderBrush" Value="{StaticResource Brush.AccentDark}" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border CornerRadius="10"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" Value="{StaticResource Brush.Accent}" />
                                    <Setter Property="Foreground" Value="{StaticResource Brush.Bg}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="56" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2.3*" />
            <ColumnDefinition Width="1.7*" />
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Row="0"
                   Grid.ColumnSpan="2"
                   LastChildFill="False">

            <TextBlock DockPanel.Dock="Left"
                       Style="{StaticResource Txt.Pixel}"
                       FontSize="40"
                       Height="40"
                       Width="203"
                       Text="{Binding LobbyTitle, FallbackValue=Lobby}" />

            <StackPanel DockPanel.Dock="Right"
                        Orientation="Horizontal"
                        Width="271">

                <Button Style="{StaticResource Btn.Icon}"
                        Margin="6,0"
                        ToolTip="Ajustes"
                        Width="80">
                    <StackPanel Orientation="Horizontal">
                        <Path Style="{StaticResource Icon.Gear}" />
                    </StackPanel>
                </Button>

                <Button Style="{StaticResource Btn.Icon}"
                        Margin="6,0"
                        ToolTip="Chat"
                        Width="80">
                    <Viewbox Width="28" Height="28">
                        <Canvas Width="24" Height="24">
                            <Path Style="{StaticResource Icon.Chat.Outline}"
                                  Width="24"
                                  Height="24" />

                            <Ellipse Width="2.6"
                                     Height="2.6"
                                     Canvas.Left="8"
                                     Canvas.Top="10"
                                     Fill="{StaticResource Brush.TextLight}" />
                            <Ellipse Width="2.6"
                                     Height="2.6"
                                     Canvas.Left="11.7"
                                     Canvas.Top="10"
                                     Fill="{StaticResource Brush.TextLight}" />
                            <Ellipse Width="2.6"
                                     Height="2.6"
                                     Canvas.Left="15.4"
                                     Canvas.Top="10"
                                     Fill="{StaticResource Brush.TextLight}" />
                        </Canvas>
                    </Viewbox>
                </Button>

                <Button Style="{StaticResource Btn.Icon}"
                        Margin="6,0"
                        ToolTip="Amigos"
                        Width="80">
                    <Path Style="{StaticResource Icon.Group}" />
                </Button>
            </StackPanel>
        </DockPanel>

        <Border Grid.Row="1"
                Grid.Column="0"
                Margin="0,8,8,1"
                Style="{StaticResource Card}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock Text="JUGADORES"
                           Style="{StaticResource Txt.Title}" />

                <ItemsControl Grid.Row="1"
                              ItemsSource="{Binding Players}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,6"
                                  Height="72">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="72" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0"
                                        Width="64"
                                        Height="64"
                                        CornerRadius="10"
                                        Background="{StaticResource Brush.Panel}"
                                        BorderBrush="{StaticResource Brush.AccentDark}"
                                        BorderThickness="2"
                                        Margin="0,0,8,0">
                                    <Image Source="{Binding AvatarSource}"
                                           Stretch="UniformToFill" />
                                </Border>

                                <StackPanel Grid.Column="1"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <TextBlock Style="{StaticResource Txt.Pixel}"
                                               FontSize="20"
                                               Text="{Binding DisplayName, FallbackValue=Jugador}" />
                                </StackPanel>

                                <StackPanel Grid.Column="2"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <ToggleButton Style="{StaticResource ReadyToggle}"
                                                  Margin="0,0,6,0"
                                                  Content="{Binding ReadyLabel, FallbackValue=Listo}"
                                                  IsChecked="{Binding IsReady, Mode=TwoWay}">
                                    </ToggleButton>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>

                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </Border>

        <Border Grid.Row="1"
                Grid.Column="1"
                Margin="8,8,0,4"
                Style="{StaticResource Card}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock Text="CONFIGURACIÓN DE PARTIDA"
                           Style="{StaticResource Txt.Title}" />

                <ItemsControl Grid.Row="1"
                              ItemsSource="{Binding GameModes}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ToggleButton Style="{StaticResource ChipToggle}"
                                          Content="{Binding Name}"
                                          IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          Command="{Binding DataContext.SelectModeCommand,
                                                            RelativeSource={RelativeSource AncestorType=Window}}"
                                          CommandParameter="{Binding}" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <StackPanel Grid.Row="2"
                            Margin="0,10,0,10">

                    <CheckBox x:Name="chkPrivate"
                              Margin="0,0,0,8"
                              Content="Privada"
                              Foreground="{StaticResource Brush.TextLight}"
                              FontFamily="{StaticResource Font.Pixel}"
                              IsChecked="{Binding IsPrivate}" />

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Style="{StaticResource Txt.Pixel}"
                                   Margin="0,0,8,0"
                                   VerticalAlignment="Center"
                                   Text="Modo de Juego:" />
                        <ComboBox Width="180"
                                  ItemsSource="{Binding Boards}"
                                  SelectedItem="{Binding SelectedBoard}"
                                  FontFamily="{StaticResource Font.Pixel}"
                                  Foreground="{StaticResource Brush.TextLight}"
                                  Background="{StaticResource Brush.Panel}"
                                  BorderBrush="{StaticResource Brush.AccentDark}"
                                  BorderThickness="2" />
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Row="3"
                            Margin="0,0,7,0"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            RenderTransformOrigin="0.44,0.489">

                    <TextBlock Style="{StaticResource Txt.Pixel}"
                               Height="22"
                               Width="50"
                               Margin="0,0,12,0"
                               VerticalAlignment="Center"
                               Opacity="0.9"
                               Visibility="{Binding CanStart,
                                                    Converter={StaticResource BoolToVis},
                                                    ConverterParameter=False}">
                        <Run Text="Code" />
                        <Run Language="es-es" Text=":" />
                        <LineBreak />
                        <Run />
                    </TextBlock>

                    <TextBlock x:Name="tbGameCode"
                               Style="{StaticResource Txt.Pixel}"
                               Height="22"
                               Width="50"
                               Margin="0,0,12,0"
                               VerticalAlignment="Center"
                               Opacity="0.9"
                               Visibility="{Binding CanStart,
                                                    Converter={StaticResource BoolToVis},
                                                    ConverterParameter=False}">
                        <Run Text="" />
                        <Run Language="es-es" />
                        <LineBreak />
                        <Run />
                    </TextBlock>

                    <Button Content="START"
                            Style="{StaticResource Btn.Primary}"
                            MinWidth="140"
                            MinHeight="44"
                            IsEnabled="{Binding CanStart}"
                            Command="{Binding StartCommand}" />
                </StackPanel>
            </Grid>
        </Border>

        <Button x:Name="btnBack" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="0,0,0,0" Style="{StaticResource Btn.Play.Left}" Click="btnBack_Click"/>

    </Grid>
</Window>
